# 健身房运动行为与健身效果分析系统 - 功能清单

## 一、公共页面

### 1. 登录页面 (/login)
- 用户名/密码登录
- 记住密码功能
- 跳转注册页面

### 2. 注册页面 (/register)
- 用户注册表单
- 表单验证
- 角色选择

### 3. 404页面 (/404)
- 友好的错误提示
- 返回首页/上一页按钮

---

## 二、学员页面 (/student)

### 1. 🔄 刷新个人健身仪表盘 (/student/dashboard)
- **数值卡片**: 当前体重、体脂率、BMI指数
- **高峰期拥堵预警**: 当前状态、高峰时段、建议时段
- **本周运动概况**: 运动次数、运动时长、消耗卡路里
- **体重变化趋势图**: 折线图展示
- **训练计划提醒**: 今日训练安排、完成率
- **运动类型分布**: 环形饼图
- **本周运动热力图**: 时段运动强度分布

### 2. 运动日历与进度 (/student/calendar)
- **交互式日历**: 日期选择器
- **运动记录表格**: 详细运动数据
- **添加运动记录**: 表单对话框
- **运动类型分布**: 饼图展示

### 2.5 运动打卡 (/student/checkin)
- **一键打卡表单**: 运动类型 + 日期 + 时长 + 备注
- **快捷时长按钮**: 20/30/45/60 分钟快速填充
- **实时落库**: 提交后写入 `exercise_records`
- **今日汇总**: 今日打卡次数、今日总时长
- **连续打卡天数**: 自动计算 streak
- **近7日趋势**: 每日时长条形趋势
- **最近打卡记录**: 最新记录表格与手动刷新

### 3. 健身效果追踪 (/student/progress)
- **体重变化趋势图**: 双轴折线图
- **体脂率变化趋势图**: 折线图
- **变化统计**: 体重/体脂/BMI变化值
- **添加身体指标**: 表单对话框

### 4. 我的训练计划 (/student/plan)
- **教练信息**: 姓名、联系方式
- **计划信息**: 目标、进度
- **周训练安排**: 每日计划
- **完成情况统计**: 进度条

### 5. 健身成就与排行榜 (/student/achievements)
- **成就统计**: 已解锁/总数、累计运动、累计卡路里
- **成就勋章墙**: 成就卡片展示
- **成就解锁时间线**: 时间轴展示
- **减重排行榜**: 排名列表
- **运动时长排行榜**: 排名列表

### 6. 运动库 (/student/exercise-library)
- **运动搜索**: 关键词搜索
- **身体部位筛选**: 17个部位分类
- **难度等级筛选**: Beginner/Intermediate/Expert
- **运动详情**: 器材、动作说明
- **分页浏览**: 2900+条运动数据

### 7. 个人中心 (/student/settings)
- **个人信息**: 展示与修改
- **修改密码**: 密码表单
- **隐私设置**: 排行榜显示、教练权限

---

## 三、教练页面 (/coach)

### 1. 学员总览仪表盘 (/coach/dashboard)
- **数值卡片**: 学员总数、男生学员、女生学员、平均年龄
- **学员健身目标分析**: 饼图（减重/减脂/增肌）
- **待办事项提醒**: 优先级列表
- **学员体重变化趋势**: 折线图
- **运动类型分布**: 饼图
- **最近活跃学员**: 表格
- **需要关注的学员**: 表格

### 2. 学员管理列表 (/coach/students)
- **学员信息表格**: 姓名、年龄、身高、体重等
- **搜索筛选**: 按条件筛选
- **查看详情**: 跳转学员分析

### 3. 学员详细分析 (/coach/students/:id)
- **基本信息**: 个人资料
- **体重变化**: 趋势图
- **体脂变化**: 趋势图
- **运动习惯分析**: 统计数据

### 4. 训练计划管理 (/coach/plans)
- **筛选功能**: 学员、目标类型、状态
- **操作按钮**: 添加、刷新
- **计划列表表格**: 学员、计划名称、目标类型、目标值、周期、状态、完成率
- **操作**: 查看、编辑、复制、删除
- **创建/编辑对话框**: 表单

### 5. 效果与对比报告 (/coach/reports)
- **减重效果排行榜**: 条形图
- **运动量与效果关联**: 散点图
- **学员进度对比**: 对比图表

### 6. 个人中心 (/coach/settings)
- **个人信息**: 展示与修改
- **修改密码**: 密码表单

---

## 四、管理员页面 (/admin)

### 1. 教练管理 (/admin/coaches)
- **教练列表**: CRUD操作
- **搜索筛选**: 按条件筛选
- **添加/编辑教练**: 表单对话框

### 2. 学员管理 (/admin/students)
- **学员列表**: CRUD操作
- **搜索筛选**: 按条件筛选
- **添加/编辑学员**: 表单对话框

### 3. 健身房全局监控 (/admin/monitoring)
- **统计卡片**: 总用户数、活跃用户、本周时长、本周卡路里
- **高峰期拥堵预警**: 当前状态、预警信息
- **各时段在线人数热力图**: 周/时段热力图
- **用户增长趋势**: 折线图
- **运动类型分布**: 饼图
- **高峰期时段分析**: 柱状图
- **器材使用率**: 条形图（颜色区分使用率）
- **教练工作量统计**: 表格

### 4. 用户行为分析 (/admin/analytics)
- **关键指标**: 活跃率、留存率、平均时长、完成率
- **用户活跃度趋势**: 折线图
- **用户留存分析**: 图表
- **运动偏好分析**: 图表
- **时段活跃度分布**: 图表
- **排行榜**: 运动时长、卡路里、减重

---

## 五、技术架构

### 前端
- Vue 3.3.4 + Vue Router + Pinia
- Element Plus UI组件库
- ECharts 数据可视化
- Vite 构建工具

### 后端
- Spring Boot 2.7.18
- MyBatis Plus 3.5.3.1
- JWT 认证
- MySQL 8.0

### 数据处理
- Python 数据清洗脚本
- Pandas 数据处理
- 支持Kaggle数据集导入

---

## 六、项目脚本

### 启动脚本
| 脚本 | 功能 |
|------|------|
| `quick-start.bat` | `start-all.bat` 别名入口 |
| `start-all.bat` | IDEA 一键入口（迁移 + 启动前后端） |
| `migrate-and-start.bat` | 方案B一键迁移并启动（命令行推荐） |
| `migrate-scheme-b.bat` | 仅执行方案B迁移（不启动服务） |
| `stop.bat` / `stop-all.bat` | 停止所有服务 |
| `check-env.bat` | 检测运行环境 |
| `install-deps.bat` | 安装项目依赖 |
| `init-database.bat` | 初始化数据库 |
| `import-data.bat` | 导入清洗后的数据 |
| `seed-all-db-artifacts.bat` | 一键重建真实页面数据（含 API 冒烟校验） |

### 一键命令速查（换机可直接执行）
| 场景 | 命令 |
|------|------|
| IDEA 一键启动（推荐） | `start-all.bat` |
| 命令行一键迁移+启动 | `migrate-and-start.bat` |
| 仅迁移不启动 | `migrate-and-start.bat --no-start --no-pause` |
| 大数据模式迁移+启动 | `migrate-and-start.bat --large` |
| 先清洗再迁移+启动 | `migrate-and-start.bat --clean-first` |
| 迁移后附带 API 冒烟 | `migrate-and-start.bat --with-api-smoke` |
| 环境检查（无阻塞） | `check-env.bat --no-pause` |
| 依赖安装（无阻塞） | `install-deps.bat --no-pause` |
| 导入清洗数据（无阻塞） | `import-data.bat --no-pause` |
| 导入大数据（无阻塞） | `import-large-data.bat --no-pause` |
| 停止服务（无阻塞） | `stop.bat --no-pause` |

可选数据库环境变量（执行命令前设置）：
`MYSQL_HOST`、`MYSQL_PORT`、`MYSQL_USER`、`MYSQL_PASSWORD`、`MYSQL_DB`

### 数据处理脚本 (data-processing/)
| 脚本 | 功能 |
|------|------|
| `comprehensive_csv_cleaner.py` | 综合CSV数据清洗 |
| `csv_data_cleaner.py` | CSV清洗 |
| `simple_data_cleaner.py` | 简单清洗 |
| `spark_data_cleaner.py` | Spark大数据清洗 |
| `spark_analyzer.py` | Spark数据分析 |

### 数据收集脚本 (data-collection/)
| 脚本 | 功能 |
|------|------|
| `data_generator.py` | 生成模拟健身数据 |
| `fitness_data_crawler.py` | 健身数据爬虫 |
| `kaggle_downloader.py` | Kaggle数据集下载 |
| `web_scraper.py` | 网页数据抓取 |
| `enhanced_dataset_collector.py` | 增强数据集收集 |

### 数据库脚本 (database/)
| 脚本 | 功能 |
|------|------|
| `import_cleaned_data.py` | 导入清洗后的CSV数据 |
| `ensure_recent_student_activity.py` | 补齐近期运动/体测与本周覆盖 |
| `backfill_exercise_created_at.py` | 回填运动时间，修复时段统计偏差 |
| `seed_analytics_tables.py` | 重建 analytics 结果表 |
| `seed_user_achievements.py` | 按真实记录重建学员成就 |
| `schema.sql` | 数据库表结构 |

### 联通校验脚本
| 脚本 | 功能 |
|------|------|
| `scripts/api_smoke_check.py` | 按 admin/coach/student 进行核心接口冒烟检查（失败返回非0） |

---

## 七、数据可视化图表

| 图表类型 | 使用场景 |
|---------|---------|
| 折线图 | 体重变化、用户增长趋势 |
| 饼图/环形图 | 运动类型分布、健身目标分析 |
| 柱状图 | 高峰期分析、排行榜 |
| 热力图 | 时段在线人数、运动强度分布 |
| 进度条 | 计划完成率、目标进度 |
| 散点图 | 运动与效果关联分析 |
| 时间线 | 成就解锁记录 |
| 仪表盘 | 完成率展示 |

---

## 七、默认账号（重建后）

| 角色 | 用户名 | 密码 |
|------|--------|------|
| 管理员 | admin_auto_001 | 123456 |
| 教练 | coach_auto_001 | 123456 |
| 学员 | 数据库真实学员账号 | 123456 |

---

## 九、数据库表结构

| 表名 | 说明 | 记录数 |
|------|------|--------|
| `users` | 用户表（学员/教练/管理员） | ~1,100 |
| `exercise_records` | 运动记录表 | ~60,000 |
| `body_metrics` | 身体指标表（体重/体脂等） | ~11,000 |
| `training_plans` | 训练计划表 | - |
| `achievements` | 成就定义表 | - |
| `user_achievements` | 用户成就关联表 | - |
| `leaderboards` | 排行榜表 | - |
| `exercise_reference` | 运动参考库 | 2,909 |
| `equipment_usage` | 器材使用记录 | - |

---

## 十、项目目录结构

```
jianshen/code/
├── backend/                    # 后端 Spring Boot 项目
│   ├── gym-common/            # 公共模块
│   ├── gym-domain/            # 实体模块
│   ├── gym-repository/        # 数据访问层
│   ├── gym-service/           # 业务逻辑层
│   └── gym-web/               # Web 控制层
├── frontend/                   # 前端 Vue 3 项目
│   └── src/
│       ├── api/               # API 接口封装
│       ├── components/        # 公共组件
│       ├── layouts/           # 布局组件
│       ├── router/            # 路由配置
│       └── views/             # 页面视图
├── database/                   # 数据库脚本
├── data-collection/            # 数据收集脚本
├── data-processing/            # 数据清洗脚本
│   └── cleaned/               # 清洗后的CSV数据
├── csv/                        # 原始数据文件
├── check-env.bat              # 环境检测
├── install-deps.bat           # 安装依赖
├── init-database.bat          # 初始化数据库
├── start-all.bat              # IDEA一键入口（迁移+启动）
├── stop.bat                   # 停止服务
├── quick-start.bat            # start-all 别名
└── README.md                  # 项目说明
```
